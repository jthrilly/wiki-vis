function signum(t){return 0>t?-1:1}function absolute(t){return 0>t?-t:t}function drawPath(t,i,e,a,o,r){var n=parseFloat(i.attr("stroke-width"));t.attr("height")<r&&t.attr("height",r),t.attr("width")<e+n&&t.attr("width",e+n),t.attr("width")<o+n&&t.attr("width",o+n);var s=.15*(o-e),l=.15*(r-a),d=l<absolute(s)?l:absolute(s),h=0,c=1;e>o&&(h=1,c=0),i.attr("x1",e),i.attr("y1",a),i.attr("x2",o),i.attr("y2",r)}function connectElements(t,i,e,a){var o=$("#simple-map");if(e.offset().top>a.offset().top){var r=e;e=a,a=r}var n=o.offset().top,s=o.offset().left,l=e.offset(),d=a.offset(),h=l.left+.5*e.outerWidth()-s,c=l.top+.5*e.outerHeight()-n,f=d.left+.5*a.outerWidth()-s,u=d.top+.5*e.outerHeight()-n;drawPath(t,i,h,c,f,u)}function getRandomLatLng(){var t=(180*Math.random()).toFixed(3),i=Math.floor(Math.random());0==i&&(t=-1*t);var e=(90*Math.random()).toFixed(3),i=Math.floor(Math.random());return 0==i&&(e=-1*e),new L.LatLng(t,e)}function generateRandomChain(){var t={},e=3,a=10;t.chainID=Math.floor(1e5*Math.random()),t.issuesMap=["Working Conditions","Human Rights","Environmental Damage","Conflict","Animal welfare","Child labour","Forced Labour ","Tax Avoidance","Other"],t.chainURL="http://wikichains.oii.ox.ac.uk/chains/"+t.chainID,t.chainName="Chain Example",t.children=[],t.edges=[];var o=Math.floor(10*Math.random())+1;for(i=0;o>i;i++){var r={};r.id=Math.floor(1e5*Math.random()),r.title="Article "+r.id,r.type=Math.floor(6*Math.random()),r.url="http://wikichains.oii.ox.ac.uk/article/"+r.id,r.coordinates=getRandomLatLng(),t.children.push(r)}for($.each(t.children,function(e,a){a.issues=[];var o=Math.floor(9*Math.random());for(i=0;o>i;i++)t:for(;;)if(thisIssue=Math.floor(Math.random()*t.issuesMap.length),-1==a.issues.indexOf(thisIssue)){a.issues.push(thisIssue);var r=i+1;break t}}),i=0;i<t.children.length-1;i++){var n={};n.from=i,n.to=i+1,t.edges.push(n)}return JSON.stringify(t)}Object.defineProperty(Array.prototype,"remove",{enumerable:!1,value:function(t){for(var i=0,e=0;e<this.length;e++)this[e]===t&&(this.splice(e,1),i++,e--);return i}});var colors={blue:"#0000ff",gold:"#C99A2E",red:"Tomato"},wikiVis=function(t){var e={simple:!1,elem:"map",mapHeight:"500px",mapWidth:"100%",data:void 0},a=this,o=t||e,r=o.data;leaflet={},el=$("#"+o.elem);var n=[];return a.drawData=function(){$.each(r.children,function(t,i){a.addPoint(i)}),$.each(r.edges,function(t,i){var e=r.children[i.from].coordinates,o=r.children[i.to].coordinates;a.addEdge(e,o)})},a.addPoint=function(t){var i=t.coordinates,e={};e.issues=t.issues;var a=new L.RadialChainMarker(i,e).addTo(leaflet),a=new L.Marker(i,{radius:5,zIndexOffset:1e3}).addTo(leaflet)},a.addEdge=function(t,i){var e=leaflet.getBounds(),a=e.getSouthWest(),o=e.getNorthEast(),r=o.lng-a.lng,n=o.lat-a.lat,s=[t,i],l={color:colors.red,weight:4},d=new L.ArcedPolyline(s,l).addTo(leaflet)},a.init=function(){console.log("init: simple settings == false"),L.Icon.Default.imagePath="components/leaflet/dist/images",console.log("setting width of container:"),console.log($(el)),$(el).width(o.mapWidth).height(o.mapHeight);var t=new L.StamenTileLayer("toner-lite");leaflet=L.map(o.elem,{zoom:3,center:[51.505,-.09]}),leaflet.addLayer(t),L.RadialChainMarker=L.ChartMarker.extend({initialize:function(t,i){L.Util.setOptions(this,i),L.ChartMarker.prototype.initialize.call(this,t,i)},options:{weight:1,opacity:1,color:"#000",fill:!1,radius:45,rotation:360,numSegments:9,offset:0,barThickness:20,maxDegrees:360,iconSize:new L.Point(50,40),backgroundStyle:{fill:!0,fillColor:"#707070",fillOpacity:1,opacity:1,color:"#505050"},colors:L.ColorBrewer.Qualitative.Set1[9]},_loadComponents:function(){var t,e,a,o=0,r=0,n=this.options.maxDegrees||360,s=this.options.radiusX||this.options.radius,l=this.options.radiusY||this.options.radius,d=this.options.issues,h=this.options.barThickness||4,c=this.options.colors;for(i=0;9>i;i++){t=i+1;var f=360/this.options.numSegments*i,u=360/this.options.numSegments*(i+1),g={};g.startAngle=f,g.endAngle=u,g.fillColor=-1!=d.indexOf(i)?c[i]:"rgba(0,0,0,0)",g.opacity=1,g.fillOpacity=1,g.weight=1,g.color="rgba(0,0,0,0)",g.fill=!0,g.offset=2,g.radiusX=40,g.radiusY=40,g.barThickness=23,g.rotation=0,g.key=i,g.dropShadow=!1,g.gradient=!1,g.value=t,bar=new L.RadialBarMarker(this._latlng,g),this.addLayer(bar)}}})},a.init(),a.drawData(),a},simpleWikiVis=function(t){var i={elem:"simple-map",mapWidth:"100%",data:void 0},e=this,a=t||i,o=a.data;el=$("#"+a.elem),$(el).width(a.mapWidth);var r=[],n=0,s=new Array;return e.drawData=function(){$.each(s,function(t,i){$(".row-container").append('<div class="row"></div>');var e=$(".grid").outerHeight()*$(".row").length;100>e&&(e=100),$("#svg1, .simple-map").css({height:e});var a=-1*e;$(".row").css({top:a}),$.each(s[t],function(t,i){var e=$(".row:last").outerWidth()+$(".grid").outerWidth();$(".row:last").css({width:e}),$("#svg1").outerWidth()<e&&$("#svg1").css({width:e}),$(".row:last").append(0!=i?'<div class="grid"><div class="circle" id="'+i[0].id+'"></div><div class="article-text">'+i[0].id+"</div></div>":'<div class="grid"></div>')})}),$.each(o.edges,function(t,i){var e=document.createElementNS("http://www.w3.org/2000/svg","line"),a=$(e).attr({});$("#svg1").append(a);var r=o.children[i.from].id,n=o.children[i.to].id;connectElements($("#svg1"),$(e),$("#"+r),$("#"+n))})},e.init=function(){console.log("init"),console.log("init: simple settings == true"),$.each(o.children,function(t,i){r.push(i.id)});var t=r;$.each(o.edges,function(i,e){t.remove(o.children[e.to].id)});for(var i=t,e=0,a=!0,n=0;a;){var l=[];i.length>0?($.each(i,function(t,i){if(s[e]instanceof Array);else{s[e]=new Array;for(var a=0;a<o.children.length;a++)s[e].push(0)}s[e][n]instanceof Array||(s[e][n]=new Array),s[e][n].push({id:i,key:t});var r=s[e][n].length-1;l=[],$.each(o.edges,function(t,e){o.children[e.from].id==i&&l.push(o.children[e.to].id)}),e++}),i=l,e=0,n++):a=!1}},e.init(),e.drawData(),e};
//# sourceMappingURL=./main.min.map